《金融计量学杂志》，2009年，第7卷，第2期，174-196页

# 一个简单的已实现波动率近似长记忆模型

**作者：FULVIO CORSI** 卢加诺大学与瑞士金融研究所

---

### **摘要**

本文提出了一个由不同时间周期上定义的波动率成分构成的加性级联模型。这种波动率级联模型引出了一个关于已实现波动率的简单AR型模型，其特点是考虑了在不同时间范围上实现的波动率成分，因此被称为**异质自回归已实现波动率模型（HAR-RV）**。尽管其结构简单且不具备真正的长记忆特性，但仿真结果表明，HAR-RV模型成功地以一种非常易于处理和简约的方式，再现了金融回报率的主要经验特征（长记忆性、肥尾和自相似性）。此外，实证结果显示其具有非常出色的预测性能。

**(JEL分类: C13, C22, C51, C53)**

**关键词：** 高频数据，长记忆模型，已实现波动率，波动率预测

---

### **1\. 引言**

金融数据呈现出一系列众所周知的典型化事实，这些事实对标准的计量经济学模型构成了严峻的挑战。平方回报率和绝对回报率的自相关性表现出非常强的持续性，这种持续性会延续很长一段时间（数月）。不同时间跨度下的回报率分布呈现出肥尾和尾部交叉现象，即回报率的概率密度函数是尖峰的，其形状依赖于时间尺度，并且随着时间尺度的增加，向正态分布的收敛速度非常缓慢。金融数据还表现出标度性和多重标度性（即绝对回报率的不同幂次具有不同的标度指数）。¹

标准的GARCH和随机波动率模型无法再现所有这些特征。观测到的数据在所有时间尺度上都显示出价格变化幅度的显著波动，而标准的GARCH和随机波动率短记忆模型在较长时间段上进行聚合后，看起来就像白噪声（没有标度行为）。因此，金融计量经济学领域最近对长记忆过程的兴趣日益浓厚。

长记忆波动率通常通过使用分数阶差分算子来获得，如回报率的FIGARCH模型或已实现波动率的ARFIMA模型。分数阶积分通过对无限变量滞后项施加一组无限维的约束，以一种简约的方式实现长记忆性。这些约束由分数阶差分算子传递。然而，分数阶积分模型也带来了一些问题。分数阶积分是一个方便的数学技巧，但缺乏明确的经济解释。Comte和Renault（1998）认为，分数阶差分滤波器 $(1−L)d$ 引入了长短期特征之间的人为混合，使得难以将它们分离开来。分数阶积分模型的估计并非易事，且不易扩展到多变量过程。² 此外，分数阶差分算子的应用需要一个较长的构建期，这会导致许多观测值的损失。最后，这类模型只能再现单分形（或单标度）类型的标度行为，而无法再现经验数据中发现的多重标度行为。

另一种方法将数据中观察到的长记忆和多重标度特征视为一种表观行为，这种行为由一个并非真正具有长记忆或多重标度性质的过程生成。如果聚合水平相对于模型的最低频率成分不够大，那么真正的渐近短记忆和单标度模型实际上可能被误认为是长记忆和多重标度模型。换句话说，即使不存在长记忆和多重标度，仅仅因为我们能够考虑的最大聚合水平实际上不够大，对经验数据使用的常规检验也可能指示出它们的存在。例如，LeBaron（2001）表明，一个仅由三个不同AR(1)过程之和定义的非常简单的加性模型，其记忆衰减模式可以被误认为是双曲线衰减（前提是其中最长成分的半衰期相对于测试的聚合范围要长）。³ 这意味着能够生成数据中典型化事实的随机过程集合比通常认为的要大得多。

鉴于在经验上很难从统计上区分真正的长记忆过程和只有少数时间尺度的简单成分模型，并且后者在估计和解释上要容易得多，我们遵循这种替代观点，提出了一个用于条件波动率的简单成分模型，该模型能够再现数据中观察到的主要经验特征，同时保持简约且易于估计。受Müller等人（1997）和Dacorogna等人（1998）的HARCH模型以及波动率在长短时间范围之间不对称传播的启发，我们提出了一个由不同类型市场参与者的行为生成的不同波动率成分的加性级联模型。这种加性波动率级联引出了一个关于已实现波动率的简单AR型模型，其特点是考虑了在不同时间范围上实现的波动率。因此，我们将此模型称为**异质自回归已实现波动率模型（HAR-RV）**。令人惊讶的是，尽管其结构简单且形式上不属于长记忆模型类别，HAR-RV模型仍能再现经验数据中观察到的相同波动率持续性以及金融数据的许多其他主要典型化事实。

本文的其余部分安排如下。第2节介绍模型的符号和推导，并展示模拟的HAR-RV序列的性质。第3节描述实证研究中使用的数据集，并呈现模型的估计和预测结果，并与一些基准模型进行比较。第4节进行总结。

---

### **2\. 模型**

#### **2.1 符号**

在本节中，我们介绍在不同时间范围上聚合的积分潜在波动率和已实现波动率的符号。

让我们从一个标准的连续时间过程开始：
```math
dp(t)=\mu(t)dt+\sigma(t)dW(t) \quad (1)
```
其中 $p(t)$ 是瞬时价格的对数， $\mu(t)$ 是右连续有左极限（cadlág）的有限变差过程， $W(t)$ 是标准布朗运动， $\sigma(t)$ 是一个独立于 $W(t)$ 的随机过程。对于这个扩散过程，与第 $t$ 天相关的积分方差是在一天区间 $[t−1d,t]$ 上的瞬时方差的积分，其中一个完整的交易日由时间间隔 $1d$ 表示：
```math
IV_t^{(d)}=\int_{t−1d}^t\sigma^2(\omega)d\omega \quad (2) 
```
一些作者将此量称为积分波动率，而我们将这个术语用于积分方差的平方根，即在我们的符号中，积分波动率是 $\sigma_t^{(d)}=(IV_t^{(d)})^{1/2}$ 。

正如Andersen、Bollerslev、Diebold和Labys（2001），Andersen、Bollerslev、Diebold和Ebens（2001），以及Barndorff-Nielsen和Shephard（2002a, 2002b）在一系列开创性论文中所示，积分方差 $IV_t^{(d)}$ 可以通过日内平方回报率的总和以任意精度进行近似。重要的是，Andersen、Bollerslev、Diebold和Labys（2003）表明，直接对已实现波动率进行时间序列建模，在样本外预测方面，其表现显著优于流行的GARCH和随机波动率模型。对于一个等间隔回报序列，一天时间间隔内的已实现波动率的标准定义是： 
```math
RV_t^{(d)}=\sqrt {\sum_{j=0}^{M−1}r_{t−j/\Delta}^2} \quad (3) 
```
其中 $\Delta=1d/M$ ，而 $r_{t−j\cdot\Delta}=p({t−j\cdot\Delta})−p(t−(j+1)\cdot\Delta)$ 定义了连续复利的 $\Delta$ 频率回报率，即在时间间隔 $\Delta$ 上采样的日内回报率（这里，下标 $t$ 表示天，而 $j$ 表示第 $t$ 天内的时间）。

在下文中，我们还将考虑在超过一天的时间范围上观察的潜在积分波动率和已实现波动率。为了能够直接比较在不同时间范围上定义的量，这些多周期波动率是单周期已实现波动率的归一化总和（即每日量的简单平均值）。例如，在我们的符号中， $t$ 时刻的周度已实现波动率由以下平均值给出：
```math
RV_t^{(w)}=\frac{1}{5}(RV_t^{(d)}+RV_{t−1d}^{(d)}+\cdots+RV_{t−4d}^{(d)}) \quad (4) 
```
特别地，我们将使用周度和月度的聚合周期。用上标表示聚合周期，周度积分波动率和已实现波动率的符号分别为 $σ_t^{(w)}$ 和 $RV_t^{(w)}$ ，而月度聚合则表示为 $σ_t^{(m)}$ 和 $RV_t^{(m)}$ 。在下文中，无论其实际频率如何，所有回报率和波动率量都将被年化，以便于不同频率之间的比较。

#### **2.2 动机**

模型的动机源于Müller等人（1993）提出的所谓**异质市场假说（Heterogeneous Market Hypothesis）**，该假说承认交易者之间存在异质性。这种金融市场观点可以与Peters（1994）的“分形市场假说”、Lux和Marchesi（1999）以及Alfarano和Lux（2007）的“互动代理人观点”以及LeBaron（2006）的“基于代理人”模型联系起来。波动率过程中存在多个成分的思想也由Andersen和Bollerslev（1997）在他们的“分布混合假说”中提出。在后一种观点中，多成分结构源于信息到达的异质性。

在金融市场中，异质性可能由多种原因引起：代理人禀赋的差异、制度约束、风险偏好的不同、信息处理方式的差异、时间范围、地理位置等等。在这里，我们关注源于时间范围差异的异质性。通常，一个金融市场由具有广泛交易频率的参与者组成。在一端，我们有交易商、做市商和日内投机者，他们的交易频率非常高，以日内为交易范围。在另一端，有机构投资者，如保险公司和养老基金，他们交易频率低得多，可能交易量更大。主要思想是，具有不同时间范围的代理人感知、反应并导致不同类型的波动率成分。简化一点，我们可以识别出三个主要的波动率成分：具有每日或更高交易频率的短期交易者，通常每周调整其头寸的中期投资者，以及具有一个月或更长时间特征的长期代理人。尽管这种分类在金融市场的简单观察中找到了其合理性，并具有清晰且吸引人的经济解释，但在计量经济学建模中却基本上被忽视了。一个值得注意的例外是Müller等人（1997）和Dacorogna等人（1998）的HARCH模型。⁵

研究在不同时间范围上测量的波动率之间的相互关系，可以揭示不同市场成分的动态。最近观察到，较长时间间隔上的波动率对较短时间间隔上的波动率的影响，要强于反向的影响。这种波动率的不对称行为已通过不同的统计工具得到证实。⁶

整体呈现的模式是从低频到高频的**波动率瀑布**。这在经济学上可以解释为，对于短期交易者而言，长期波动率的水平很重要，因为它决定了未来趋势和风险的预期规模。因此，一方面，短期交易者通过修正其交易行为来应对长期波动率的变化，从而导致短期波动率。另一方面，短期波动率的水平不影响长期交易者的交易策略。这种层级结构促使一些作者提出了外汇动态与湍流流体运动之间的形式类比，后者存在从大空间尺度到小空间尺度的乘性能量级联。最近，Calvet和Fisher（2004, 2007）提出了一个多频率模型，该模型是通过大量在不同频率下运行的马尔可夫转换过程（以不同的概率转换表示）的乘积获得的。

受仅有少数相关成分的简单模型能够复制金融数据统计行为的理论能力，以及异质市场结构产生波动率瀑布的经验观察的启发，我们提出了一个具有三个异质波动率成分的波动率级联模型。

#### **2.3 HAR-RV模型**

将由某个市场成分产生的潜在部分波动率定义为 $\tilde{\sigma}_t^{(\cdot)}$ ，所提出的模型可以描述为部分波动率的加性级联，每个部分都具有“近似AR(1)”的结构。为简化起见，我们考虑一个仅有三个波动率成分的层级模型，对应于一天（1d）、一周（1w）和一个月（1m）的时间范围，分别表示为 $\tilde{\sigma}_t^{(d)}$ 、 $\tilde{\sigma}_t^{(w)}$ 和 $\tilde{\sigma}_t^{(m)}$ 。显然，可以轻松添加更多成分。同样，为了便于阐述，这里的模型是为已实现波动率（即方差的平方根变换）呈现（并随后使用）的，但也可以为方差或其对数变换编写类似的模型。

高频回报过程由级联中最高频率的波动率成分（在这个简化案例中是日度成分）决定，其中 $\tilde{\sigma}_t^{(d)}={\sigma}_t^{(d)}$ 是日度积分波动率。那么回报过程是：
```math
r_t=\sigma_t^{(d)}ϵ_t \quad (5)
```
其中 $ϵ_t\sim NID(0,1)$ 。级联中每个层级的未观测部分波动率过程 $\tilde\sigma_t^{(⋅)}$ 被假定为在相同时间尺度上经历的过去已实现波动率的函数（“AR(1)”成分），并且由于波动率的不对称传播，还依赖于对下一周期更长期部分波动率的期望（层级成分）。对于最长的时间尺度（月度），只剩下“AR(1)”结构。那么模型为：
```math
\begin{aligned}
\tilde\sigma_{t+1m}^{(m)}&=c^{(m)}+\phi^{(m)}RV_t^{(m)}+\tilde\omega_{t+1m′}^{(m)} \\ \tilde\sigma_{t+1w}^{(w)}&=c^{(w)}+\phi^{(w)}RV_t^{(w)}+γ^{(w)}\mathbb{E}_t\left[\tilde\sigma_{t+1m}^{(m)}\right]+\tilde\omega_{t+1w′}^{(w)} \\
\tilde\sigma_{t+1d}^{(d)}&=c^{(d)}+\phi^{(d)}RV_t^{(d)}+γ^{(d)}\mathbb{E}_t\left[\tilde\sigma_{t+1w}^{(w)}\right]+\tilde\omega_{t+1d}^{(d)}
\end{aligned}
```
其中 $RV_t^{(d)}、RV_t^{(w)} 和 RV_t^{(m)}$ 分别是如前所述的日度、周度和月度（事后）观测到的已实现波动率，而波动率创新项 $\tilde\omega_{t+1m′}^{(m)}、\tilde\omega_{t+1w′}^{(w)}、\tilde\omega_{t+1d}^{(d)}$ 是同期和序列上独立的零均值扰动项，其左尾被适当截断以保证部分波动率的正性。⁹

其经济解释是，级联中的每个波动率成分对应一个市场成分，该成分基于对当前已实现波动率的观察以及对更长时间范围波动率的期望（已知会影响其相关波动率的未来水平）来形成对下一周期波动率的期望。

通过对部分波动率进行直接的递归替换，并回顾 $\tilde{\sigma}_t^{(d)}={\sigma}_t^{(d)}$ ，这样一个级联模型可以简单地写为：
```math
\sigma_{t+1d}^{(d)}=c+β^{(d)}RV_t^{(d)}+β^{(w)}RV_t^{(w)}+β^{(m)}RV_t^{(m)}+\tilde\omega_{t+1d}^{(d)} \quad (6) 
```
方程（6）可以看作是一个三因子随机波动率模型，其中因子直接是过去在不同频率下观察到的已实现波动率。

从这个潜在波动率的过程中，很容易推导出已实现波动率的时间序列模型函数形式，只需注意到，事后 $\sigma_{t+1d}^{(d)}$ 可以写为：
```math
\sigma_{t+1d}^{(d)}=RV_{t+1d}^{(d)}+\omega_{t+1d}^{(d)} \quad (7) 
```
其中 $\omega_t^{(d)}$ 包含了潜在日度波动率的测量和估计误差。方程（7）将我们的事后波动率估计 $RV_{t+1d}^{(d)}$ 与同期的日度潜在波动率度量 $\sigma_{t+1d}^{(d)}$ 联系起来。¹⁰

将方程（7）代入方程（6），并考虑到因变量上的测量误差可以被吸收到回归的扰动项中，我们得到了所提出的级联模型的一个非常简单的时间序列表示：
```math
RV_{t+1d}^{(d)}=c+β^{(d)}RV_t^{(d)}+β^{(w)}RV_t^{(w)}+β^{(m)}RV_t^{(m)}+\omega_{t+1d} \quad (8) 
```
其中 $\omega_{t+1d}=\tilde\omega_{t+1d}^{(d)}−\omega_{t+1d}^{(d)}$ 。方程（8）在已实现波动率中具有简单的自回归结构，但其特点是考虑了在不同区间大小上实现的波动率；因此可以标记为HAR(3)-RV。

#### **2.4 仿真结果**

本节的目的是展示，尽管所提出的模型结构简单，但它能够为回报率和波动率生成丰富的动态，这些动态与我们在经验数据中观察到的情况非常接近。这些动态是由不同市场成分对给定价格变化的异质反应产生的，而这种反应反过来又影响未来价格变化的幅度。这导致了一个复杂的过程，市场以不同的反应时间对其自身的价格历史做出反应。因此，市场波动率是自我驱动的。¹²

为了评估模型复制经验数据主要典型化事实的能力，我们将HAR(3)-RV模型仿真产生的回报率和波动率时间序列与美元/瑞郎（USD/CHF）序列（在3.1节中描述）进行比较。为了使模型具有在日度水平上展现其动态所需的时间聚合，HAR(3)-RV过程以两小时（2h）的频率进行仿真（对应于一个完整的24小时交易日，M=12）。仿真模型为： 
```math
\begin{aligned}
r_t^{(2h)}&=\sigma_t^{(d)}ϵ_t \quad (9) \\
\sigma_{t+2lt}^{(d)}&=c+β^{(d)}RV_t^{(d)}+β^{(w)}RV_t^{(w)}+β^{(m)}RV_t^{(m)}+ω_{t+2h}^{(d)} \quad (10) 
\end{aligned}
```
模型的参数 ( $β(⋅)$ ) 经过简单校准以获得现实的结果。它们是 $β^{(d)}=0.36$ ， $β(w)=0.28$ 和 $β^{(m)}=0.28$ 。

分析始于对回报率（图1）和已实现波动率（图2）两个时间序列样本的简单目视检查。在图1和图2中，上方面板显示了美元/瑞郎的经验数据样本，而下方面板显示了仿真过程的一个在视觉上非常相似的样本实现。

**图1：实际（上）与仿真（下）日度回报序列的比较** 

<img width="761" height="656" alt="image" src="https://github.com/user-attachments/assets/bfb969f0-05d6-4d18-8aaa-3a41a22056f1" />

**图2：实际（上）与仿真（下）日度已实现波动率（RV）序列的比较** 

<img width="765" height="644" alt="image" src="https://github.com/user-attachments/assets/d18d450d-5a12-467c-93cf-0951d5c88dc5" />


图3总结了仿真和实际回报在1天、5天和22天区间上的分布特征。在这些及后续的比较图中，真实数据和仿真数据的观测数量有很大差异。14年的美元/瑞郎数据产生了3599个日度观测值，而HAR(3)-RV过程的仿真期对应于150,000个日度观测值（约600年）。

**图3：不同时间范围下实际（点线）与仿真（实线）回报率概率密度函数的比较。从左到右：日度、周度、月度。** 

<img width="812" height="337" alt="image" src="https://github.com/user-attachments/assets/5360ce9a-c3de-454e-8950-57e65a3162be" />

表1报告了对应于三个聚合区间的分布峰度值。该表清楚地显示了简单的HAR模型不仅能够再现日度回报的超额峰度，还能再现随着聚合区间增加，从肥尾分布到瘦尾分布的经验性交叉现象。

**表1：峰度**

|  | 日度回报 | 周度回报 | 月度回报 |
| --- | --- | --- | --- |
| **USD/CHF** | 4.74 | 3.82 | 3.24 |
| **HAR(3)-RV** | 4.89 | 3.90 | 3.50 |

*注：比较不同时间范围下实际和仿真的回报峰度。* 

然而，我们主要感兴趣的是模型再现经验数据波动率持续性的能力。图4显示了美元/瑞郎日度已实现波动率的实际自相关函数¹³，以及在对应600年期间仿真的HAR日度已实现波动率的自相关函数。该图表明，再现经验波动率长记忆性的目的似乎已完全实现。需要强调的是，理论上HAR波动率模型是一个短记忆过程，渐近地不应表现出双曲线衰减的自相关性。然而，对于所考虑的聚合区间，仿真模型显示的波动率记忆至少与经验数据一样长（并且通过适当选择参数，甚至可以使其更长）。

**图4：实际（点线）与仿真（实线）日度已实现波动率自相关的比较** 

<img width="810" height="512" alt="image" src="https://github.com/user-attachments/assets/77d90b1e-6aea-4765-ac4a-b1d89f1259fa" />

偏自相关函数也表现出相当显著的一致性（图5）。日度已实现波动率的分布（图6）和周期图的标度行为（图7）也取得了类似的结果，两者都显示出高度的线性（这是真实自相似过程的典型特征）。

<img width="793" height="625" alt="image" src="https://github.com/user-attachments/assets/d3e2e973-014d-4885-9a67-3158e3ad14b5" />

<img width="792" height="504" alt="image" src="https://github.com/user-attachments/assets/98b807d0-f349-4ff0-b176-09dc1fef4d9f" />

<img width="789" height="655" alt="image" src="https://github.com/user-attachments/assets/a13e2381-d089-4d4b-986b-45312f02ae87" />

---

### **3\. 实证分析**

#### **3.1 数据**

我们的数据集包括美元/瑞郎（USD/CHF）、标普500指数期货（S&P500 Futures）和30年期美国国债期货（30-year US Treasury Bond Futures）的长周期逐笔（tick-by-tick）数据。美元/瑞郎序列涵盖了从1989年12月到2003年12月的14年逐笔现货对数中间价。对数中间价是根据路透社FXFX屏幕获得的对数买入价和卖出价的平均值计算的。为了避免显式地对由周末引起的交易活动的季节性行为进行建模，我们排除了从周五格林威治标准时间21:00到周日22:00之间发生的所有已实现波动率。对于标普500指数期货，我们拥有从1990年1月到2007年7月的所有交易数据，而对于国债期货，我们的数据序列是从1990年1月到2003年10月。对于所有三个序列，我们采用Zhang, Aït-Sahalia, and Mykland（2005）提出的双尺度估计量，以十个tick的回报作为较慢的频率，来计算每日的逐笔已实现波动率估计值。如前所述，每日已实现波动率按照方程（4）在周度和月度尺度上进行聚合，以便在不同时间范围上获得可比较的已实现波动率度量。

#### **3.2 估计**

遵循近期关于已实现波动率的文献，我们可以将方程（8）中的所有项都视为可观测的，然后通过应用简单的线性回归轻松估计其参数 $β(⋅)$ 。标准的普通最小二乘法（OLS）回归估计量是一致且正态分布的。为了考虑数据中可能存在的序列相关性，我们采用了Newey-West协方差修正。

表2报告了方程（8）的HAR-RV模型对三个序列的估计结果。从t统计量的值可以看出，在三个不同时间范围上聚合的三个已实现波动率都非常显著。唯一的例外是国债期货的日度已实现波动率系数。这个结果可能是因为国债期货的已实现波动率时间序列似乎比标普500和美元/瑞郎的噪声水平更高，¹⁴ 这归因于其平均tick到达频率较低以及市场微观结构的更高影响。日度已实现波动率的噪声估计导致日度波动率成分缺乏显著性，而周度和月度已实现波动率作为更长时期的平均值，可能包含较少的噪声和更多关于波动率过程的信息，因此在模型中获得了更高的权重。

**表2：HAR(3)估计**
$RV_{t+1d}^{(d)}=c+\beta^{(d)}RV_t^{(d)}+\beta^{(w)}RV_t^{(w)}+\beta^{(m)}RV_t^{(m)}+\omega_{t+1d}$
|  | USD/CHF | S&P500 | T-Bond |
| --- | --- | --- | --- |
| **c** | 0.781 (5.404) | 1.121 (4.065) | 1.494 (6.475) |
| **βd​** | 0.352 (13.501) | 0.372 (9.858) | 0.039 (1.672) |
| **βw​** | 0.343 (7.263) | 0.323 (7.509) | 0.412 (8.941) |
| **βm​** | 0.224 (6.467) | 0.235 (6.301) | 0.361 (7.987) |

 *注：括号内为基于Newey-West修正（5阶序列相关）计算的标准误的t统计量。*

值得注意的是，如果我们接受在不同时间范围上聚合的已实现波动率是相应市场成分产生的波动率的合理代理这一解释，那么这个简单OLS回归的一个有趣的副产品就是对市场成分权重的直接估计。例如，在美元/瑞郎和标普500序列中，市场成分的重要性似乎随着聚合范围的增加而降低。

如上所述，HAR-RV过程是一个通过施加具有经济意义的约束而进行简约重参数化的自回归模型。我们可以通过比较受约束的HAR模型与不受约束的AR模型来评估这些约束是否有效。由于这里考虑的HAR模型使用了月度已实现波动率（对应22个工作日），相应的不受约束自回归模型是AR(22)。表3报告了F检验和信息准则的结果。F检验对三个序列都显著，¹⁵ 而信息准则给出的结果则不那么明确：AR(22)和HAR(3)的AIC非常相似，而基于BIC（对额外系数施加更大惩罚），HAR(3)明显更优。

**表3：拟合优度检验**

|  | USD/CHF | S&P500 | T-Bond |
| --- | --- | --- | --- |
| **F-test** | 2.801 (1.910) | 3.498 (1.909) | 4.585 (1.912) |
| **AIC** |  |  |  |
| AR(22) | 1.929 | 2.577 | 1.898 |
| HAR(3) | 1.928 | 2.579 | 1.903 |
| **BIC** |  |  |  |
| AR(22) | 1.969 | 2.611 | 1.938 |
| HAR(3) | 1.935 | 2.585 | 1.910 |

 *注：F检验括号内为1%临界值。* 

#### **3.3 预测**

模型的样本内单日预测如图8和表4所示。这些预测是通过首先估计全样本上模型的参数，然后进行一系列静态一步预测而获得的。图8顶部和中间面板所示的相当准确的预测的视觉印象得到了表4中回归的显著高R2的证实。从图8的右侧面板（显示了预测误差的时间序列）可以看出，残差中存在明显的异方差。这一评论促使Corsi、Mittnik、Pigorsch和Pigorsch（2008）考虑了更复杂的估计程序，能够考虑波动残差中的GARCH效应，可以提高HAR-RV模型的估计效率。

**表4：单日样本内性能**

|  | RMSE | MAE | R2 |
| --- | --- | --- | --- |
| **USD/CHF** |  |  |  |
| AR(1) | 2.803 | 1.938 | 0.493 |
| AR(3) | 2.675 | 1.830 | 0.539 |
| ARFIMA(5,d,0) | 2.649 | 1.765 | 0.559 |
| HAR(3) | 2.607 | 1.757 | 0.565 |
| **S&P500** |  |  |  |
| AR(1) | 3.927 | 2.542 | 0.648 |
| AR(3) | 3.690 | 2.364 | 0.691 |
| ARFIMA(5,d,0) | 3.611 | 2.316 | 0.703 |
| HAR(3) | 3.605 | 2.305 | 0.707 |
| **T-Bond** |  |  |  |
| AR(1) | 2.770 | 2.080 | 0.109 |
| AR(3) | 2.683 | 2.010 | 0.166 |
| ARFIMA(5,d,0) | 2.580 | 1.919 | 0.237 |
| HAR(3) | 2.576 | 1.905 | 0.236 |

*注：性能度量为均方根误差（RMSE）、平均绝对误差（MAE）和Mincer-Zarnowitz回归的 R2。* 


为了进行比较，添加了其他模型：已实现波动率的AR(1)和AR(3)模型，以及Andersen、Bollerslev、Diebold和Labys（2003）采用的已实现波动性的分数积分模型。他们提出了对已实现波动率序列进行分数微分，通过GPH算法在全样本上估计分数系数d，然后进行AR(5)拟合。因此，该模型是用两步程序估计的ARFIMA(5,d,0)。

在表4中，基于均方根误差（RMSE）和平均绝对误差（MAE）对预测性能进行了评估。此外，根据Andersen和Bollerslev（1998）、Andersen、Bollerslew和Diebold（2007）以及Ait Sahalia和Mancini（2008）的分析，表4还报告了Mincer-Zarnowitz回归的 $R^2$ 结果
```math
RV_t^{(d)}=b_0+b_1\mathbb{E}_{t-1}\left[\left(\widehat{RV}_t^{(d)}\right)\right]+\text{error} ,\quad (11)
```
也就是说，将事后实现的波动率回归到一个常数上，并基于时间 $t-1$ 信息进行各种模型预测。在表4中，标准短记忆模型和能够捕捉经验数据持久性的模型之间的预测性能差异是显而易见的。

表5和图9报告了已实现波动率的样本外预测结果，其中模型在1000个观测值的移动窗口上每日重新估计。一个例外是ARFIMA模型，其分数差分系数d首先在整个样本上估计。预测性能在三个不同的时间范围上进行比较：一天、一周和两周。对于分数差算子，我们选择泰勒展开的标准截止极限1000，对于0.4左右的d值，这会导致约4%的截止误差。经过分数微分后，用于估计AR参数的移动窗口的最佳长度约为250天。

**表5：样本外预测** 
<img width="797" height="489" alt="image" src="https://github.com/user-attachments/assets/da401ecb-ad17-4cfe-b70f-b50d9810afb8" />

*注：比较AR（1）、AR（3）、ARFIMA（5，d，0）和HAR（3）模型对美元/瑞士法郎交易所数据、标准普尔500指数期货和国债期货的1天、1周和2周预测的样本外表现。AR（1）、AR（3）和HAR（3）每天在1000个观测值的移动窗口上重新估计。对于ARFIMA（5，d，0），在整个样本上预先估计分数积分系数d。在泰勒展开的截止极限为1000的分数微分后，用于估计AR（5）参数的移动窗口的最佳长度约为250天。性能指标是均方根误差（RMSE）、平均绝对误差（MAE）和Mincer-Zarnowitz回归的R2。对多阶段预测进行评估，比较多时期内累计的实际波动率和预测波动率。*

---

预测性能在三个不同时间跨度上进行比较：一天、一周和两周。多步超前预测的评估是基于在整个多期跨度内已实现和预测的聚合波动率进行的。对于 $h$ 步超前预测，其目标函数即为已实现波动率 $\sum_{j=0}^hRV_{t+j}^{(d)}$ ，此时明瑟-扎尔诺维茨回归将变为
```math
\sum_{j=0}^hRV_{t+j}^{(d)} = b_0+b_1\mathbb{E}_{t-h}\left[\sum_{j=0}^h\widehat{RV}_{t+j}^{(d)}\right]+\text{error}. \quad (12)
```

在样本外，简约的HAR(3)模型在所有三个考虑的时间范围（一天、一周和两周）上都稳定地优于短记忆模型，并且与真正的长记忆ARFIMA模型表现相当。值得注意的是，尽管ARFIMA和HAR(3)的优越性能在日度范围上已经很明显，但在周度和双周范围上则变得惊人。原因是AR(1)和AR(3)模型的记忆相对于预测时间范围来说太短，因此在较长的预测时间范围上会过快地收敛到其无条件均值。

<img width="794" height="689" alt="image" src="https://github.com/user-attachments/assets/9d0c5e3a-c8e1-494d-8975-c579e8f4a5e8" />

**图9** 美元/瑞士法郎交易所数据（顶部）、标准普尔500指数期货（中部）和国债期货（底部）的AR(3)、ARFIMA(5,d,0)和HAR(3)模型2周前预测的样本外表现比较实线是汇总预测，虚线是2周内事后汇总的已实现波动率。AR(3)和HAR(3)每天在1000次观测的移动窗口上重新估计。对于ARFIMA(5,d,0)，在整个样本上预先估计分数差参数。在截断极限为1000的分数微分后，用于估计AR(5)参数的移动窗口的最佳长度约为250天。

---

这一解释得到了图9的证实，图9比较了不同模型在两周预测期内的动态行为。在这个时间范围内，长记忆的重要性变得显而易见。令人惊讶的是，HAR-RV模型仅用几个参数就能获得这些结果。

面对HAR(3)和ARFIMA(5,d,0)的结果，表5显示这两个模型的性能是可比的（HAR模型在每日和每周范围内以及ARFIMA在双周范围内略有优势）¹⁶。然而需要指出的是，HAR模型具有极高的简便性和易操作性（即使在日度移动窗口上也能轻松实现），而ARFIMA模型则显得更为繁琐复杂（尤其在移动窗口操作时）。此外，ARFIMA模型的估计与预测结果对分数差分算子的泰勒展开截断限值选择相当敏感；当采用GPH方法估计长期记忆参数d时，其对频率截止值的选择也十分敏感。


---

### **4\. 结论**

我们提出了一个波动率模型，其中受异质市场假说启发的加性波动率级联引出了一个关于已实现波动率的简单AR型模型。该模型的特点是考虑了在不同区间大小上实现的波动率。我们称此模型为HAR-RV。

新的HAR-RV模型似乎成功地以一种非常简单和简约的方式（尽管形式上不属于长记忆模型类别）实现了对波动率长记忆行为的建模。此外，尽管其结构和估计简单，HAR-RV模型显示出非常好的预测性能。基于对美元/瑞郎、标普500和国债期货三个长序列已实现波动率的样本外预测结果，HAR(3)模型在所有考虑的时间范围（一天、一周和两周）上都稳定地优于短记忆模型，并且与估计起来复杂得多的长记忆ARFIMA模型相当。

该模型的简洁性使其能够轻松向多个方向拓展。只需将其他在统计学和经济学上显著的变量作为额外回归因子加入即可。例如，可参照Andersen等（2007）及Corsi、Pirino与Renò（2008）的研究，在分离连续波动成分后纳入不同的跳跃测度；亦可借鉴Corsi与Reno（2008）的方法，通过添加滞后正负收益率作为回归因子来考虑杠杆效应。若要将HAR模型扩展至非线性效应领域，可分别参照McAleer与Medeiros（2008）以及Audrino与Corsi（2008）的研究，将其与平滑转换模型或树结构模型相结合。基于异质成分的相同逻辑，还可应用于其他模型——例如Engle与Gallo（2006）在乘性误差模型中提出的已实现波动率建模与预测的替代方法。此外，其简单的自回归结构暗示了向多元情形扩展的自然途径：参照Bauer与Vorkink（2007）的标准VAR模型，构建与之对应的向量HAR模型。


---

¹ 丁、格兰杰和恩格尔（1993）、安德森和博勒斯勒夫（1997）、洛巴托和萨文（1998）以及达科罗尼亚、根恰伊、穆勒、奥尔森和皮克泰（2001）发现了金融数据中的标度（分形）和多重标度（多分形）行为的证据（尽管没有明确使用多重标度或多分形的术语）。 ² 这些缺点在FIGARCH的情况下很明显。但对于ARFIMA模型，也已表明，例如通过Geweke-Porter-Hudak（GPH）方法单独估计d的启发式方法，会给出显著有偏和低效的估计，尤其是在存在大的AR或MA根的情况下（这似乎是我们的情况）。 ³ 鉴于格兰杰（1980）的结果，即无限多个短记忆过程的和可以产生长记忆，长记忆作为短记忆过程组合的出现并不令人惊讶。然而，令人惊讶的是，这些结果仅用三个不同的时间尺度就可以模仿。 ⁵ HARCH过程属于广泛的ARCH家族，但与其他所有ARCH类型过程的不同之处在于其考虑不同区间上聚合的平方回报的独特性质。 ⁶ 穆勒等人（1997）采用“精细”和“粗略”波动率的领先-滞后相关性分析来研究格兰杰意义上的因果关系。阿尔内奥多、穆齐和索内特（1998）以及根恰伊和塞尔丘克（2004）进行了小波分析，而林奇和祖姆巴赫（2003）通过绘制波动率一阶差分与已实现波动率之间的相关性水平，清晰地展示了这种不对称传播。 ⁹ 确保部分波动率正性的另一种方法是以RV的对数形式编写模型。 ¹⁰ 方程（7）中存在一个均值为零的误差项 ωt+1d(d)​，这清楚地表明我们没有将已实现波动率视为潜在波动率的无误差度量。 ¹² 这种机制有时被称为“价格驱动的波动率”，与符合有效市场假说（EMH）的“事件驱动的波动率”以及由于市场对传入信息过度或反应不足而产生的“误差驱动的波动率”形成对比。 ¹³ 使用Zhang, Aït-Sahalia, and Mykland（2005）的双尺度估计量计算，如3.1节所述。 ¹⁴ 这通过自相关函数的比较以及HAR估计的低得多的R²得到证实。 ¹⁵ 鉴于约束数量（19）和观测值数量较多，联合F检验的拒绝在某种程度上是可以预期的。¹⁶然而需要指出的是，ARFIMA模型的预测并非真正意义上的样本外预测，因为其分数差分系数d是基于全体样本进行估计的。
